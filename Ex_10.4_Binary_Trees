Declaration: Tree : Type â†’ Type

Declaration:          â—¬   : Tree A
Precedence 60 for:  _â—¿_â—º_
Non-associating:    _â—¿_â—º_
Declaration:        _â—¿_â—º_ : Tree A â†’ A â†’ Tree A â†’ Tree A

Declaration: t1 : Tree â„•
Axiom â€œDefinition of `t1`â€:
  t1 = ((â—¬ â—¿ 2 â—º â—¬) â—¿ 3 â—º (â—¬ â—¿ 5 â—º â—¬))
       â—¿ 7 â—º
       (â—¬ â—¿ 10 â—º (â—¬ â—¿ 11 â—º â—¬))

Declaration: ï½¢_ï½£ : A â†’ Tree A
Axiom â€œSingleton treeâ€: ï½¢ x ï½£ = â—¬ â—¿ x â—º â—¬

Fact â€œAlternative definition of `t1`â€:
  t1 = (ï½¢ 2 ï½£ â—¿ 3 â—º ï½¢ 5 ï½£)
       â—¿ 7 â—º
       (â—¬ â—¿ 10 â—º ï½¢ 11 ï½£)
Proof:
  By â€œDefinition of `t1`â€ and â€œSingleton treeâ€

Declaration: _Ë˜ : Tree A â†’ Tree A
Axiom â€œMirrorâ€: â—¬ Ë˜  = â—¬
Axiom â€œMirrorâ€: (l â—¿ x â—º r) Ë˜  =  (r Ë˜) â—¿ x â—º (l Ë˜)

Theorem â€œMirroring singleton treesâ€: ï½¢ x ï½£ Ë˜ = ï½¢ x ï½£
Proof:
    ï½¢ x ï½£ Ë˜
  =âŸ¨ â€œSingleton treeâ€ âŸ©
    (â—¬ â—¿ x â—º â—¬) Ë˜
  =âŸ¨ â€œMirrorâ€ âŸ©
    (â—¬ Ë˜) â—¿ x â—º (â—¬ Ë˜)
  =âŸ¨ â€œMirrorâ€ âŸ©
    â—¬  â—¿ x â—º â—¬
  =âŸ¨ â€œSingleton treeâ€ âŸ©
    ï½¢ x ï½£  
  
Axiom â€œTree inductionâ€:
     P[t â‰” â—¬]
  âˆ§  ( âˆ€ l, r : Tree A; x : A
       â€¢ P[t â‰” l] âˆ§ P[t â‰” r]  â‡’  P[t â‰” l â—¿ x â—º r]
     )
  â‡’  (âˆ€ t : Tree A â€¢ P)

Theorem â€œSelf-inverse of tree mirrorâ€: âˆ€ t : Tree A â€¢ (t Ë˜) Ë˜ = t
Proof:
  Using â€œTree inductionâ€:
    Subproof for `â—¬ Ë˜ Ë˜ = â—¬`: By â€œMirrorâ€
    Subproof for `âˆ€ l, r : Tree A; x : A
         â€¢ (l Ë˜) Ë˜ = l âˆ§ (r Ë˜) Ë˜ = r
         â‡’ (l â—¿ x â—º r)Ë˜ Ë˜ = (l â—¿ x â—º r)`:
       For any `l, r, x`:
         Assuming â€œIHLâ€ `(l Ë˜) Ë˜ = l`,
                  â€œIHRâ€ `(r Ë˜) Ë˜ = r`:
             (l â—¿ x â—º r) Ë˜ Ë˜
           =âŸ¨ â€œMirrorâ€ âŸ©
             (l Ë˜ Ë˜) â—¿ x â—º (r Ë˜ Ë˜)
           =âŸ¨ Assumptions â€œIHLâ€ and â€œIHRâ€ âŸ©
             l â—¿ x â—º r

Declaration: size : Tree A â†’ â„•
Axiom â€œTree sizeâ€: size â—¬  = 0
Axiom â€œTree sizeâ€: size (l â—¿ x â—º r)  =  size l + 1 + size r

Lemma â€œSingleton tree sizeâ€: size ï½¢ x ï½£ = 1
Proof:
    size ï½¢ x ï½£
  =âŸ¨ â€œSingleton treeâ€ âŸ©
    size (â—¬ â—¿ x â—º â—¬)
  =âŸ¨ â€œTree sizeâ€ âŸ©
    0 + 1 + 0
  =âŸ¨ Evaluation âŸ©
    1   

Fact â€œSize of `t1`â€: size t1 = 6
Proof:
    size t1
  =âŸ¨ â€œAlternative definition of `t1`â€,
     â€œSingleton tree sizeâ€, â€œTree sizeâ€,
     â€œIdentity of +â€ âŸ©
    1 + 1 + 1 + 1 + 1 + 1
  =âŸ¨ Evaluation âŸ©
    6

Theorem â€œSize of mirrored treeâ€:
    âˆ€ t : Tree A â€¢ size (t Ë˜) = size t
Proof:
  Using â€œTree inductionâ€:
    Subproof for `size (â—¬ Ë˜) = size â—¬`: By â€œMirrorâ€
    Subproof for `âˆ€ l, r : Tree A; x : A
         â€¢ size (l Ë˜) = size l âˆ§ size (r Ë˜) = size r
         â‡’ size ((l â—¿ x â—º r) Ë˜) = size (l â—¿ x â—º r)`:
       For any `l, r, x`:
         Assuming (L) `size (l Ë˜) = size l`,
                  (R) `size (r Ë˜) = size r`:
             size ((l â—¿ x â—º r) Ë˜)
           =âŸ¨ â€œMirrorâ€ âŸ©
             size (r Ë˜ â—¿ x â—º l Ë˜)
           =âŸ¨ â€œTree sizeâ€ âŸ©
             size (r Ë˜) + 1 + size (l Ë˜) 
           =âŸ¨ Assumptions (L) and (R) âŸ©
             size r + 1 + size l
           =âŸ¨ â€œTree sizeâ€ âŸ©
             size (l â—¿ x â—º r)  

Declaration: map : (A â†’ B) â†’ Tree A â†’ Tree B
Axiom â€œTree mapâ€: map f â—¬ = â—¬
Axiom â€œTree mapâ€: map f (l â—¿ x â—º r) = (map f l) â—¿ (f x) â—º (map f r)

Theorem â€œSize of mapped treeâ€:
    âˆ€ t â€¢  size (map f t) = size t
Proof:
  Using â€œTree inductionâ€:
    Subproof for `size (map f â—¬) = size â—¬`:
      By â€œTree mapâ€, â€œTree sizeâ€
    Subproof for `âˆ€ l, r : Tree A; x : A â€¢ 
                  size (map f l) = size l âˆ§ size (map f r) = size r
                  â‡’ size (map f (l â—¿ x â—º r)) = size (l â—¿ x â—º r)`:
      For any `l, r, x`:
        Assuming (L) `size (map f l) = size l`,
                 (R) `size (map f r) = size r`:
            size (map f (l â—¿ x â—º r))
          =âŸ¨ â€œTree mapâ€ âŸ©
            size ((map f l) â—¿ (f x) â—º (map f r))
          =âŸ¨ â€œTree sizeâ€ âŸ©
            size (map f l) + 1 + size (map f r)
          =âŸ¨ Assumption (L), Assumption (R) âŸ©
            size l + 1 + size r
          =âŸ¨ â€œTree sizeâ€ âŸ©
            size (l â—¿ x â—º r) 
          
Declaration: preOrder, inOrder, postOrder : Tree A â†’ Seq A

Axiom â€œDefinition of `preOrder`â€:
     preOrder â—¬ = ğœ–
  âˆ§  preOrder (l â—¿ x â—º r) = x â—ƒ preOrder l âŒ¢ preOrder r

Lemma â€œSingleton `preOrder`â€: preOrder ï½¢ x ï½£ = x â—ƒ ğœ–
Proof:
    preOrder ï½¢ x ï½£ 
  =âŸ¨ â€œSingleton treeâ€ âŸ©
    preOrder (â—¬ â—¿ x â—º â—¬)
  =âŸ¨ â€œDefinition of `preOrder`â€ âŸ©
    x â—ƒ preOrder â—¬ âŒ¢ preOrder â—¬
  =âŸ¨ â€œDefinition of `preOrder`â€ âŸ©
    x â—ƒ ğœ– âŒ¢ ğœ–
  =âŸ¨ â€œLeft-identity of âŒ¢â€ âŸ©
    x â—ƒ ğœ–  
    
Fact: preOrder t1 = 7 â—ƒ 3 â—ƒ 2 â—ƒ 5 â—ƒ 10 â—ƒ 11 â—ƒ ğœ–
Proof:
    preOrder t1
  =âŸ¨ â€œAlternative definition of `t1`â€,
     â€œDefinition of `preOrder`â€,
     â€œSingleton `preOrder`â€ âŸ©
    7 â—ƒ (3 â—ƒ (2 â—ƒ ğœ–) âŒ¢ 5 â—ƒ ğœ–) âŒ¢ (10 â—ƒ ğœ– âŒ¢ 11 â—ƒ ğœ–)
  =âŸ¨ â€œDefinition of âŒ¢ for ğœ–â€, â€œDefinition of âŒ¢ for â—ƒâ€ âŸ©
     7 â—ƒ 3 â—ƒ 2 â—ƒ 5 â—ƒ 10 â—ƒ 11 â—ƒ ğœ–

Axiom â€œDefinition of `inOrder`â€:
     inOrder â—¬ = ğœ–
  âˆ§  inOrder (l â—¿ x â—º r) = inOrder l âŒ¢ x â—ƒ inOrder r

Lemma â€œSingleton `inOrder`â€: inOrder ï½¢ x ï½£ = x â—ƒ ğœ–
Proof:
    inOrder ï½¢ x ï½£ 
  =âŸ¨ â€œSingleton treeâ€ âŸ©
    inOrder (â—¬ â—¿ x â—º â—¬)
  =âŸ¨ â€œDefinition of `inOrder`â€ âŸ©
    inOrder â—¬ âŒ¢ x â—ƒ inOrder â—¬
  =âŸ¨ â€œDefinition of `inOrder`â€ âŸ©
    ğœ– âŒ¢ x â—ƒ ğœ–
  =âŸ¨ â€œLeft-identity of âŒ¢â€ âŸ©
    x â—ƒ ğœ– 

Fact: inOrder t1 = 2 â—ƒ 3 â—ƒ 5 â—ƒ 7 â—ƒ 10 â—ƒ 11 â—ƒ ğœ–
Proof:
    inOrder t1
  =âŸ¨ â€œAlternative definition of `t1`â€ âŸ©
    inOrder ((ï½¢ 2 ï½£ â—¿ 3 â—º ï½¢ 5 ï½£)
              â—¿ 7 â—º
            (â—¬ â—¿ 10 â—º ï½¢ 11 ï½£))
  =âŸ¨ â€œDefinition of `inOrder`â€ âŸ©
    inOrder (ï½¢ 2 ï½£ â—¿ 3 â—º ï½¢ 5 ï½£)
    âŒ¢ (7 â—ƒ inOrder (â—¬ â—¿ 10 â—º ï½¢ 11 ï½£))
  =âŸ¨ â€œDefinition of `inOrder`â€ âŸ©
    (inOrder ï½¢ 2 ï½£ âŒ¢ 3 â—ƒ inOrder ï½¢ 5 ï½£) 
    âŒ¢ (7 â—ƒ (inOrder â—¬ âŒ¢ 10 â—ƒ inOrder ï½¢ 11 ï½£ ))
  =âŸ¨ â€œSingleton `inOrder`â€, â€œDefinition of `inOrder`â€ âŸ©
    ( (2 â—ƒ ğœ–) âŒ¢ 3 â—ƒ 5 â—ƒ ğœ–) âŒ¢
    (7 â—ƒ (ğœ– âŒ¢ 10 â—ƒ 11 â—ƒ ğœ–))
  =âŸ¨ â€œDefinition of âŒ¢ for ğœ–â€, â€œDefinition of âŒ¢ for â—ƒâ€ âŸ©
    2 â—ƒ 3 â—ƒ 5 â—ƒ 7 â—ƒ 10 â—ƒ 11 â—ƒ ğœ– 

Axiom â€œDefinition of `postOrder`â€:
     postOrder â—¬ = ğœ–
  âˆ§  postOrder (l â—¿ x â—º r) = postOrder l âŒ¢ postOrder r â–¹ x

Lemma â€œSingleton `postOrder`â€: postOrder ï½¢ x ï½£ = x â—ƒ ğœ–
Proof:
    postOrder ï½¢ x ï½£ 
  =âŸ¨ â€œSingleton treeâ€ âŸ©
    postOrder (â—¬ â—¿ x â—º â—¬)
  =âŸ¨ â€œDefinition of `postOrder`â€ âŸ©
    postOrder â—¬ âŒ¢ postOrder â—¬ â–¹ x
  =âŸ¨ â€œDefinition of `postOrder`â€ âŸ©
    ğœ– âŒ¢ ğœ– â–¹ x
  =âŸ¨ â€œLeft-identity of âŒ¢â€ âŸ©
    ğœ– â–¹ x
  =âŸ¨ â€œDefinition of â–¹ for ğœ–â€ âŸ©
    x â—ƒ ğœ– 

Fact: postOrder t1 = 2 â—ƒ 5 â—ƒ 3 â—ƒ 11 â—ƒ 10 â—ƒ 7 â—ƒ ğœ–
Proof:
    postOrder t1
  =âŸ¨ â€œAlternative definition of `t1`â€ âŸ©
    postOrder ((ï½¢ 2 ï½£ â—¿ 3 â—º ï½¢ 5 ï½£)
              â—¿ 7 â—º
              (â—¬ â—¿ 10 â—º ï½¢ 11 ï½£))
  =âŸ¨ â€œDefinition of `postOrder`â€ âŸ©
    postOrder (ï½¢ 2 ï½£ â—¿ 3 â—º ï½¢ 5 ï½£) 
    âŒ¢ postOrder (â—¬ â—¿ 10 â—º ï½¢ 11 ï½£) â–¹ 7
  =âŸ¨ â€œDefinition of `postOrder`â€ âŸ©
    (postOrder ï½¢ 2 ï½£ âŒ¢ postOrder ï½¢ 5 ï½£ â–¹ 3) 
    âŒ¢ (postOrder â—¬ âŒ¢ postOrder ï½¢ 11 ï½£ â–¹ 10) â–¹ 7 
  =âŸ¨ â€œSingleton `postOrder`â€, â€œDefinition of `postOrder`â€ âŸ©
    ((2 â—ƒ ğœ–) âŒ¢ (5 â—ƒ ğœ–) â–¹ 3) 
    âŒ¢ (ğœ– âŒ¢ (11 â—ƒ ğœ–) â–¹ 10) â–¹ 7
  =âŸ¨ â€œLeft-identity of âŒ¢â€ âŸ©
    ((2 â—ƒ ğœ–)  âŒ¢ (5 â—ƒ ğœ–) â–¹ 3) 
    âŒ¢ ((11 â—ƒ ğœ–) â–¹ 10) â–¹ 7
  =âŸ¨ â€œDefinition of â–¹ for â—ƒâ€, â€œDefinition of â–¹ for ğœ–â€ âŸ©
    ((2 â—ƒ ğœ–)  âŒ¢ 5 â—ƒ 3 â—ƒ ğœ–) 
    âŒ¢ 11 â—ƒ 10 â—ƒ 7 â—ƒ ğœ–
  =âŸ¨ â€œDefinition of âŒ¢ for â—ƒâ€ âŸ©
    2 â—ƒ (ğœ–  âŒ¢ 5 â—ƒ 3 â—ƒ ğœ–) 
    âŒ¢ 11 â—ƒ 10 â—ƒ 7 â—ƒ ğœ–
  =âŸ¨ â€œDefinition of âŒ¢ for ğœ–â€ âŸ©
    2 â—ƒ (5 â—ƒ 3 â—ƒ ğœ–) 
    âŒ¢ 11 â—ƒ 10 â—ƒ 7 â—ƒ ğœ–
  =âŸ¨ â€œDefinition of âŒ¢ for â—ƒâ€ âŸ© 
    2 â—ƒ (5 â—ƒ (3 â—ƒ ğœ–) âŒ¢ 11 â—ƒ 10 â—ƒ 7 â—ƒ ğœ–)
  =âŸ¨ â€œDefinition of âŒ¢ for â—ƒâ€ âŸ©
    2 â—ƒ (5 â—ƒ (3 â—ƒ (ğœ– âŒ¢ 11 â—ƒ 10 â—ƒ 7 â—ƒ ğœ–)))
  =âŸ¨ â€œDefinition of âŒ¢ for ğœ–â€ âŸ©  
    2 â—ƒ 5 â—ƒ 3 â—ƒ 11 â—ƒ 10 â—ƒ 7 â—ƒ ğœ–   
  
Lemma â€œDefinition of `map` for âŒ¢â€: map f (xs âŒ¢ ys) = map f xs âŒ¢ map f ys
Proof:
  By induction on `xs : Seq A`:
    Base case `map f (ğœ– âŒ¢ ys) = map f ğœ– âŒ¢ map f ys`:
      By â€œLeft-identity of âŒ¢â€, â€œDefinition of `map` for ğœ–â€
    Induction step `âˆ€ x : A â€¢ map f ((x â—ƒ xs) âŒ¢ ys) = map f (x â—ƒ xs) âŒ¢ map f ys`:
      For any `x : A`:
          map f (x â—ƒ xs) âŒ¢ map f ys
        =âŸ¨ â€œDefinition of `map` for â—ƒâ€ âŸ©
          (f x â—ƒ map f xs) âŒ¢ map f ys
        =âŸ¨ â€œDefinition of âŒ¢ for â—ƒâ€ âŸ©
          f x â—ƒ (map f xs âŒ¢ map f ys)
        =âŸ¨ Induction hypothesis âŸ©
          f x â—ƒ map f (xs âŒ¢ ys)
        =âŸ¨ â€œDefinition of `map` for â—ƒâ€ âŸ©
          map f (x â—ƒ (xs âŒ¢ ys))
        =âŸ¨ â€œDefinition of âŒ¢ for â—ƒâ€ âŸ©
          map f ((x â—ƒ xs) âŒ¢ ys)       

Theorem â€œmap commutes with inOrderâ€:
   âˆ€ f : A â†’ B â€¢ âˆ€ t : Tree A
   â€¢ map f (inOrder t) = inOrder (map f t)
Proof:
  For any `f`:
    Using â€œTree inductionâ€:
      Subproof for `map f (inOrder â—¬) = inOrder (map f â—¬)`:
          map f (inOrder â—¬)
        =âŸ¨ â€œDefinition of `inOrder`â€ âŸ©
          map f ğœ–
        =âŸ¨ â€œDefinition of `map` for ğœ–â€âŸ©
          ğœ–
        =âŸ¨ â€œDefinition of `inOrder`â€ âŸ©
          inOrder â—¬ 
        =âŸ¨ â€œTree mapâ€ âŸ©
          inOrder (map f â—¬)
      Subproof for `âˆ€ l, r : Tree A; x : A â€¢ 
                    map f (inOrder l) = inOrder (map f l) âˆ§
                    map f (inOrder r) = inOrder (map f r)
                    â‡’    map f (inOrder (l â—¿ x â—º r)) 
                       = inOrder (map f (l â—¿ x â—º r))`:
        For any `l, r, x`:
          Assuming (L) `map f (inOrder l) = inOrder (map f l)`,
                   (R) `map f (inOrder r) = inOrder (map f r)`:
              map f (inOrder (l â—¿ x â—º r))
            =âŸ¨ â€œDefinition of `inOrder`â€ âŸ© 
              map f (inOrder l âŒ¢ x â—ƒ inOrder r)
            =âŸ¨ â€œDefinition of `map` for âŒ¢â€ âŸ©       
              map f (inOrder l) âŒ¢ map f (x â—ƒ inOrder r)
            =âŸ¨ â€œDefinition of `map` for â—ƒâ€ âŸ©
              map f (inOrder l) âŒ¢ f x â—ƒ map f (inOrder r) 
            =âŸ¨ Assumption (L), Assumption (R) âŸ©
              inOrder (map f l) âŒ¢ f x â—ƒ inOrder (map f r)
            =âŸ¨ â€œDefinition of `inOrder`â€ âŸ©  
              inOrder (map f l â—¿ f x â—º map f r)
            =âŸ¨ â€œTree mapâ€ âŸ©  
              inOrder (map f (l â—¿ x â—º r))
